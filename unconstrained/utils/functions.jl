"""
problems and helpers to generate problems
"""

module Functions
    function random_positive_definite_matrix(n)
        A = rand(n, n)
        A = A'*A
        A = (A + A')/2
    end

    function random_multivariate_pair(n)
        A = random_positive_definite_matrix(n)
        r = rand(n)
        return A, r
    end

    function problem_from_multivariate_pair(A, r)
        b = A * r

        f(x) = (x' * A * x)/2 - b'*x
        g(x) = A * x - b
        h(x) = A

        return f, g, h
    end

    function random_multivariate_problem(n)
        A, r = random_multivariate_pair(n)
        f, g, h = problem_from_multivariate_pair(A, r)
        return f, g, h, r
    end

    f(x) = x[1]^2 * x[2]^4 + (x[2]-1)^2 + 2
    f_g(x) = [2x[1]*x[2]^4; 4x[1]^2 * x[2]^3 + 2*(x[2]-1)]
    f_h(x) = [2x[2]^4 8x[2]^3*x[1]; 8x[1]*x[2]^3 12x[1]^2*x[2]^2+2]
    f_s = [0.3, 1.2] # newton's method really struggled with this, therefore the close starting point

    # A few polynomial problems
    poly1(x) = x[1]^6/6 - 3x[1]^5 + 85x[1]^4/4 - 75x[1]^3 + 137x[1]^2 - 120x[1]
    poly1_g(x) = [(x[1] - 1)*(x[1] - 2)*(x[1] - 3)*(x[1] - 4)*(x[1] - 5)]
    poly1_h(x) = [5x[1]^4 - 60x[1]^3 + 255x[1]^2 - 450x[1] + 274]
    poly1_s = [2.5]
    
    # TODO: change this
    poly2(x) = (x[1]^4)/4 - (62x[1]^3)/3 + 1181x[1]^2/2 - 6820x[1]
    poly2_g(x) = [(x[1] - 31)*(x[1] - 11)*(x[1] - 20)]
    poly2_h(x) = [3x[1]^2 - 124x[1] + 1181]
    poly2_s = [15.]

    poly3(x) = x[1]^4/4 - 10x[1]^3 + 299x[1]^2/2 - 990x[1]
    poly3_g(x) = [(x[1] - 9)*(x[1] - 10)*(x[1] - 11)]
    poly3_h(x) = [3x[1]^2 - 60x[1] + 299]
    poly3_s = [10.5]

    # TODO: change this
    poly4(x) = x[1]^4/4 - 70x[1]^3/3 + 1075x[1]^2/2 - 3750x[1]
    poly4_g(x) = [(x[1] - 50)*(x[1] - 5)*(x[1] - 15)]
    poly4_h(x) = [3x[1]^2 - 140x[1] + 1075]
    poly4_s = [70.]

    # A few fixed multivariate problems
    A1 = [5.35949832923982 4.117987785537397 3.554968126608011 4.792862290149545 3.3726022832526685 2.926289596441251 3.1380331898324227 2.855384041176427 3.7175159621977008 3.6099745275441872 3.448324714146649 3.357483180889623 3.701513500455339 4.09401716525194; 4.117987785537397 5.067053757269779 2.7656687319317284 4.261779583275638 2.8591044391435974 3.1471477434708857 2.8428292633416983 2.895378395464598 3.454079785351513 3.3774454334094117 3.003110064352589 3.211719763263506 3.3231565653852395 3.105017597372556; 3.554968126608011 2.7656687319317284 3.8153786184794836 4.053482216301305 2.4311417026854305 2.3258533241451484 2.880808702558362 2.151828335333018 3.222743814856648 2.4015209877433774 2.9288145381403665 2.670413350827355 3.3205001811638044 3.6771352291231603; 4.792862290149545 4.261779583275638 4.053482216301305 6.37926977960491 3.1660705358045034 3.3726898686080964 3.7472206059229394 2.837619139096252 4.122904366128134 4.223345698949675 4.803612436809865 4.340912877152248 4.03016132144744 4.425543823478763; 3.3726022832526685 2.8591044391435974 2.4311417026854305 3.1660705358045034 3.1943048654797304 2.0787442300952157 2.3886565246839955 2.082475285367521 2.749457777917924 2.7905355899931594 2.1501775227213473 2.1470844524740915 2.452621539347864 2.7356150293614223; 2.926289596441251 3.1471477434708857 2.3258533241451484 3.3726898686080964 2.0787442300952157 2.5925401332383036 2.116729984383217 2.3334679598899837 2.737671250365393 2.622057346235656 2.3427731475339186 2.583493637238021 2.5930092472608313 2.415680023743677; 3.1380331898324227 2.8428292633416983 2.880808702558362 3.7472206059229394 2.3886565246839955 2.116729984383217 3.579738025547276 2.1214726659011665 3.117592165865955 3.1518513121916705 2.901351363481166 2.470524671437706 3.3022477277764253 3.2971956387719508; 2.855384041176427 2.895378395464598 2.151828335333018 2.837619139096252 2.082475285367521 2.3334679598899837 2.1214726659011665 3.321257274602956 2.901642829901059 2.552806479080238 2.2414759303952954 2.7954042352968678 3.076778844096178 3.3685755579706615; 3.7175159621977008 3.454079785351513 3.222743814856648 4.122904366128134 2.749457777917924 2.737671250365393 3.117592165865955 2.901642829901059 4.8304250622533536 3.575571908675186 3.161032760749298 3.1761521172346705 3.927407669075342 3.479404342115415; 3.6099745275441872 3.3774454334094117 2.4015209877433774 4.223345698949675 2.7905355899931594 2.622057346235656 3.1518513121916705 2.552806479080238 3.575571908675186 4.4255882028823 3.4176436509553207 3.0404160543111796 4.181691071530958 3.157555416759151; 3.448324714146649 3.003110064352589 2.9288145381403665 4.803612436809865 2.1501775227213473 2.3427731475339186 2.901351363481166 2.2414759303952954 3.161032760749298 3.4176436509553207 4.092707025872223 3.503935934885812 3.3369466940116412 3.585037438287659; 3.357483180889623 3.211719763263506 2.670413350827355 4.340912877152248 2.1470844524740915 2.583493637238021 2.470524671437706 2.7954042352968678 3.1761521172346705 3.0404160543111796 3.503935934885812 3.587312773657628 2.96784972838085 3.5896826522102923; 3.701513500455339 3.3231565653852395 3.3205001811638044 4.03016132144744 2.452621539347864 2.5930092472608313 3.3022477277764253 3.076778844096178 3.927407669075342 4.181691071530958 3.3369466940116412 2.96784972838085 5.915337002464958 4.270995582665812; 4.09401716525194 3.105017597372556 3.6771352291231603 4.425543823478763 2.7356150293614223 2.415680023743677 3.2971956387719508 3.3685755579706615 3.479404342115415 3.157555416759151 3.585037438287659 3.5896826522102923 4.270995582665812 5.293303462706463]
    r1 = [0.2943929370145626, 0.41995911032957345, 0.63804270885589, 0.0395598572052116, 0.9091051204050882, 0.3515270747409531, 0.537223491853237, 0.37775620852111746, 0.6397498862526525, 0.6150507985085165, 0.13793103800959772, 0.31986453520543123, 0.5404971307511901, 0.15729794053875268]
    s1 = [8.376491493722087, -13.51562907858945, -4.181510225070436, -3.553456120130541, -5.408126805301502, -13.32909113793367, -12.917499451323518, -6.694027873142033, 1.6984274017020378, 16.266707745878733, 14.882744581555633, 0.6456040810259346, -2.0895710408748043, 8.026546620314148]

    A2 = [3.4193904496669343 2.4627670389982907 2.6875413542653117 2.613655638208468 2.9405888221778507 2.0399757945941155 2.7095688676918304 3.4908991735078967 1.5933962242115798 3.805372508578981 2.9826595972932517 3.0721365048575686 3.234656850661025 3.0430212976977913; 2.4627670389982907 6.0050788541631706 3.849487722972232 3.8312078730938612 4.689224662029284 2.838188144409284 4.394611915818537 4.9125318413929655 3.215447368116252 4.568394211727063 4.921810838494821 5.378658186556391 4.7692538731034375 3.7675727810262654; 2.6875413542653117 3.849487722972232 4.475102322479083 3.3186963080974814 3.9781598734353323 2.7552820644349194 3.5926585895330105 4.589783933133625 2.088259688025847 4.572897344845869 3.6295251874354832 3.8280033407213905 4.696499428697966 3.4364881120252995; 2.613655638208468 3.8312078730938612 3.3186963080974814 3.9882936157879705 3.8844774103508732 2.250912989722594 3.271164163264231 3.866232783342894 2.078651562508392 4.695026198460043 3.9106197037569443 3.801878063146981 3.6262035982909 3.6103803132693084; 2.9405888221778507 4.689224662029284 3.9781598734353323 3.8844774103508732 5.152955195155655 2.308513532241446 3.94358376824514 5.248465073011047 2.8424457147282305 4.76935811932958 4.162557217789299 4.815327890090512 4.478119876547679 3.1489252429038768; 2.0399757945941155 2.838188144409284 2.7552820644349194 2.250912989722594 2.308513532241446 2.897285071149833 2.4458429811656144 2.6999334044199013 1.3299685127617564 3.6799220740498186 3.1594200624365216 2.586852270830611 3.24895684484135 3.062994328108637; 2.7095688676918304 4.394611915818537 3.5926585895330105 3.271164163264231 3.94358376824514 2.4458429811656144 4.87278356884228 4.112114420953693 2.224622669366492 4.03904069371791 4.231594031247352 4.661031600663211 4.041146490674207 3.6660469076169555; 3.4908991735078967 4.9125318413929655 4.589783933133625 3.866232783342894 5.248465073011047 2.6999334044199013 4.112114420953693 6.540341171758462 3.3347696418397628 5.282498814984815 4.162762708789917 4.702996932994995 5.736633372464235 3.3788147745893493; 1.5933962242115798 3.215447368116252 2.088259688025847 2.078651562508392 2.8424457147282305 1.3299685127617564 2.224622669366492 3.3347696418397628 2.6856361164470886 2.425027006574867 2.6291346568218517 2.8815119019603017 2.801451650936819 1.7932518910733246; 3.805372508578981 4.568394211727063 4.572897344845869 4.695026198460043 4.76935811932958 3.6799220740498186 4.03904069371791 5.282498814984815 2.425027006574867 6.887936077512885 5.198992793528519 4.702973202105771 5.119223071827459 4.822768950425402; 2.9826595972932517 4.921810838494821 3.6295251874354832 3.9106197037569443 4.162557217789299 3.1594200624365216 4.231594031247352 4.162762708789917 2.6291346568218517 5.198992793528519 5.389788943656338 4.882003350832066 4.102784878650241 4.29967224748668; 3.0721365048575686 5.378658186556391 3.8280033407213905 3.801878063146981 4.815327890090512 2.586852270830611 4.661031600663211 4.702996932994995 2.8815119019603017 4.702973202105771 4.882003350832066 5.62869703429086 4.317720201535282 3.847341371335454; 3.234656850661025 4.7692538731034375 4.696499428697966 3.6262035982909 4.478119876547679 3.24895684484135 4.041146490674207 5.736633372464235 2.801451650936819 5.119223071827459 4.102784878650241 4.317720201535282 5.958632059173475 3.72128004383858; 3.0430212976977913 3.7675727810262654 3.4364881120252995 3.6103803132693084 3.1489252429038768 3.062994328108637 3.6660469076169555 3.3788147745893493 1.7932518910733246 4.822768950425402 4.29967224748668 3.847341371335454 3.72128004383858 4.580772659112899]
    r2 = [0.02628793135093055, 0.05354563921107558, 0.7139518993869516, 0.4852798020142317, 0.575268752342659, 0.43033234565120937, 0.4433513556554216, 0.0535332365939325, 0.7076635511794622, 0.8874705257516653, 0.4354290981087754, 0.04235186584243911, 0.5225279035186379, 0.10538313427079493]
    s2 = [0.37703741774420607, 14.047023173958815, 12.868460645529538, 9.249518158455585, 16.485750855879587, 5.14305174968894, 13.930026796349965, -7.497402459154145, -4.834164864662664, -14.394284848088466, -5.92776883602865, -8.46150415586976, -6.876989507311871, 6.826418695243396]

    A3 = [6.892427172172102 4.795466649251225 4.43338499968198 4.181397429053669 5.659956833771459 3.684118455673651 3.7754967923070217 5.4027799684066125 4.2946172966657645 4.828943953832042 5.2445406438319075 3.4850950953699424 4.5694373834966395 3.9698390850690073 5.754460630744617 5.759094826135863 4.710567799313767; 4.795466649251225 5.224567035925475 3.986274410972364 4.486853591622805 4.575298316399183 4.009917636533662 3.237427640760262 4.170410876214216 4.248755107207847 3.5001406063054046 3.331744640969616 3.2715089531927033 3.697412803757378 3.5928042147727686 4.048425433554984 4.659961033735323 4.198886081933817; 4.43338499968198 3.986274410972364 5.997884728623401 4.982489791902971 4.101179618611097 3.958256186788114 4.313971234271391 4.8275565603700095 3.837015605904638 3.857372911862559 3.2463030457266475 3.0676963441822784 4.748958591123392 3.8736447077582317 3.5465635154920747 4.362216731527704 4.684690048772646; 4.181397429053669 4.486853591622805 4.982489791902971 5.715035122225877 4.419992514944131 4.5916858286685756 3.510381391808891 4.621149952828651 3.7932590405248248 3.831726293730511 2.8589923560831916 3.3796286467315553 4.662685448769672 3.7645396978496266 3.1217177048467635 4.482739484536881 5.029766580722909; 5.659956833771459 4.575298316399183 4.101179618611097 4.419992514944131 6.4861032849009135 3.893636572842235 2.927313300058452 4.353695218618073 3.884324137485836 4.562042867604715 4.507232353025103 3.4177877229674922 4.69048100403423 4.3287908647293944 5.197136217559595 5.104482756746718 4.240103813511207; 3.684118455673651 4.009917636533662 3.958256186788114 4.5916858286685756 3.893636572842235 4.66774058958433 2.778403337921138 4.102338879700564 3.0633715907780665 3.3494796102563207 2.2807275451644973 2.9907627780245325 3.6421716708156766 3.525847316603985 2.9060822830162327 3.9843832877036522 4.401010473964813; 3.7754967923070217 3.237427640760262 4.313971234271391 3.510381391808891 2.927313300058452 2.778403337921138 4.021849316259638 4.200352176342324 3.1425854245255307 3.0349224506433576 2.841381179018191 2.7175568447614897 3.0296914649214197 2.6197087224549853 2.9809363718018305 3.6716805130678654 3.643728509901081; 5.4027799684066125 4.170410876214216 4.8275565603700095 4.621149952828651 4.353695218618073 4.102338879700564 4.200352176342324 6.898120682328225 3.935075041975101 4.480783305511925 3.8902582751065498 3.207287177415769 4.548540158718836 4.395559389456319 4.683853236798984 5.295531718396004 4.453982321801862; 4.2946172966657645 4.248755107207847 3.837015605904638 3.7932590405248248 3.884324137485836 3.0633715907780665 3.1425854245255307 3.935075041975101 4.870821882032983 4.108393434383468 3.1983003300494706 2.823828687605432 3.725867930313262 3.710269759977513 4.14815330918493 4.354857836665404 3.2715537598663036; 4.828943953832042 3.5001406063054046 3.857372911862559 3.831726293730511 4.562042867604715 3.3494796102563207 3.0349224506433576 4.480783305511925 4.108393434383468 5.344199343312563 4.212482697730676 2.3913891385612587 4.2082707480283705 3.9588103331428175 4.526854078038934 4.5523522305673545 3.989471900073027; 5.2445406438319075 3.331744640969616 3.2463030457266475 2.8589923560831916 4.507232353025103 2.2807275451644973 2.841381179018191 3.8902582751065498 3.1983003300494706 4.212482697730676 5.1986515713159696 2.012669836383828 3.861753971416367 3.1844034851685468 4.770581030245212 4.167589870229831 4.016902116428063; 3.4850950953699424 3.2715089531927033 3.0676963441822784 3.3796286467315553 3.4177877229674922 2.9907627780245325 2.7175568447614897 3.207287177415769 2.823828687605432 2.3913891385612587 2.012669836383828 3.686138990229991 2.8886522923821496 2.547605530172114 2.8284305999189954 3.1572158494492246 3.0217969400062357; 4.5694373834966395 3.697412803757378 4.748958591123392 4.662685448769672 4.69048100403423 3.6421716708156766 3.0296914649214197 4.548540158718836 3.725867930313262 4.2082707480283705 3.861753971416367 2.8886522923821496 5.736574776339123 4.40477657475523 3.9342180131154105 4.223400927814837 4.442178191972707; 3.9698390850690073 3.5928042147727686 3.8736447077582317 3.7645396978496266 4.3287908647293944 3.525847316603985 2.6197087224549853 4.395559389456319 3.710269759977513 3.9588103331428175 3.1844034851685468 2.547605530172114 4.40477657475523 5.0474167096085765 3.973309968907617 3.9762301504504696 3.83735733909978; 5.754460630744617 4.048425433554984 3.5465635154920747 3.1217177048467635 5.197136217559595 2.9060822830162327 2.9809363718018305 4.683853236798984 4.14815330918493 4.526854078038934 4.770581030245212 2.8284305999189954 3.9342180131154105 3.973309968907617 5.964802634614404 4.841853415821912 3.642495855097848; 5.759094826135863 4.659961033735323 4.362216731527704 4.482739484536881 5.104482756746718 3.9843832877036522 3.6716805130678654 5.295531718396004 4.354857836665404 4.5523522305673545 4.167589870229831 3.1572158494492246 4.223400927814837 3.9762301504504696 4.841853415821912 5.708850380601667 4.428187066264297; 4.710567799313767 4.198886081933817 4.684690048772646 5.029766580722909 4.240103813511207 4.401010473964813 3.643728509901081 4.453982321801862 3.2715537598663036 3.989471900073027 4.016902116428063 3.0217969400062357 4.442178191972707 3.83735733909978 3.642495855097848 4.428187066264297 6.2032023300149906]
    r3 = [0.4173240666888014, 0.9762308327036102, 0.47307142446386163, 0.13307974456470406, 0.5222019383795271, 0.46593638874705334, 0.7759280629409158, 0.4255613835053733, 0.3611491664329127, 0.38726314788522, 0.14082280514269252, 0.715558219552574, 0.8056190597863908, 0.3964761285128877, 0.5879501992223284, 0.3208023011593788, 0.29671687853779405]
    s3 = [-9.980948665133361, -4.642812818910735, 13.338452584669346, -8.777027207075415, 1.4259310318734033, 0.9307518647159616, 15.391767378921832, -4.5319939815389265, 0.5682801581344684, 0.8185375861417967, 17.932386618027017, 3.6931122994394583, -7.770173272834777, 14.745251216699309, 1.0386131232493643, 20.278939278923477, 13.249654778666724]

    A4 = [3.5260223933981596 2.3885633330009557 3.0013284856276257 2.2634207515535416 2.5315478841720367 2.1780194101118493 2.7006556624475335 3.067692845840579 3.157587502824414 2.954565746030929 3.1176411425146253; 2.3885633330009557 2.616454579573691 2.5138863050295526 1.3319878847137838 2.6940329533297533 1.464183101191927 1.5788522933386502 2.3058362303641182 2.7474003709002006 2.061043899029787 2.620022359299686; 3.0013284856276257 2.5138863050295526 3.989010650203742 2.596779182751367 3.297126870434753 2.6828546541222846 3.1140683725501495 2.5276771441358403 3.291795928744486 2.61982018621742 3.523786155601561; 2.2634207515535416 1.3319878847137838 2.596779182751367 2.6868922182373436 1.8384672417267651 2.366632199987007 2.7303934445667375 1.8545896200050571 2.634282323959729 2.2995692074128753 2.3046261496134015; 2.5315478841720367 2.6940329533297533 3.297126870434753 1.8384672417267651 3.609381492390951 1.7650889504910532 2.214398554658857 2.4067279683668175 3.2761305696586516 2.021031690606433 3.1546115717090033; 2.1780194101118493 1.464183101191927 2.6828546541222846 2.366632199987007 1.7650889504910532 2.6988570113856594 2.5535193795646713 1.8135241033306646 2.308555304083279 2.339471977072163 2.1100544778491384; 2.7006556624475335 1.5788522933386502 3.1140683725501495 2.7303934445667375 2.214398554658857 2.5535193795646713 4.083888798174832 2.9438793729956063 3.331087330002635 2.6064384543463732 2.78764824813654; 3.067692845840579 2.3058362303641182 2.5276771441358403 1.8545896200050571 2.4067279683668175 1.8135241033306646 2.9438793729956063 3.528882574803216 3.4611733454951406 2.8511305876223942 2.988515098804296; 3.157587502824414 2.7474003709002006 3.291795928744486 2.634282323959729 3.2761305696586516 2.308555304083279 3.331087330002635 3.4611733454951406 4.2929394377472025 3.168204945573304 3.572215588988659; 2.954565746030929 2.061043899029787 2.61982018621742 2.2995692074128753 2.021031690606433 2.339471977072163 2.6064384543463732 2.8511305876223942 3.168204945573304 3.3513019190835465 2.920939585281362; 3.1176411425146253 2.620022359299686 3.523786155601561 2.3046261496134015 3.1546115717090033 2.1100544778491384 2.78764824813654 2.988515098804296 3.572215588988659 2.920939585281362 3.9218617961231748]
    r4 = [0.5139836471328636, 0.35877709913571, 0.9676764665281814, 0.8633017604579725, 0.980436493779993, 0.1162563397759353, 0.2458031315704836, 0.05506735284000741, 0.07983381199845141, 0.5051930828300357, 0.011269130312429931]
    s4 = [-1.9012402990237758, -1.6084024789493756, 4.678413915327003, -0.2794207981043242, -2.8075972761657644, -10.276382640420847, -4.624091458139653, -15.45606665148466, 12.483315525378615, 2.156001263663481, -4.949392941373559]

    A5 = [4.796327607686119 2.4132544516039522 3.29678762586373 3.4130300956275863 3.4552324968555452 3.7707516179536773 4.159908132406136 4.184360673225802 3.686506754981603 3.956425592736187 3.8386930549642213 3.487930041275693 3.215753736003255; 2.4132544516039522 3.0371459737789404 2.1859456088069966 3.221129760407813 2.504900770262738 2.668872949588451 2.9685000431455273 2.999061735347273 2.6338157258426955 2.3170316055470366 2.19639343438095 2.4064248519728495 2.5181103351141845; 3.29678762586373 2.1859456088069966 3.733398493459838 2.3799164908705532 2.3682553354600864 3.520531455781242 2.4857795647201764 3.7714074061222664 3.1816399590200897 2.579382316215362 2.8456661210289584 2.516956735298323 1.8823421427694251; 3.4130300956275863 3.221129760407813 2.3799164908705532 4.679272752646118 4.036206159472965 3.6997259858427824 4.268972425667618 4.03957854108814 3.2689718094946736 3.0788109823745433 2.7715184944657283 3.406436892560917 3.573253183231616; 3.4552324968555452 2.504900770262738 2.3682553354600864 4.036206159472965 4.231620039952541 3.6589475960062927 3.815773975910807 4.096553260767219 3.1160453242472235 3.0433254088403214 2.5230618484755913 3.378845552461686 3.209605597849173; 3.7707516179536773 2.668872949588451 3.520531455781242 3.6997259858427824 3.6589475960062927 5.305045484619503 3.2815161040421943 4.4041920574947735 3.8202191319196657 3.1552546912847643 3.278891977454557 3.5342434612124354 3.2276762871187223; 4.159908132406136 2.9685000431455273 2.4857795647201764 4.268972425667618 3.815773975910807 3.2815161040421943 4.881417009737005 4.063701078068846 3.4811602063535116 3.593823727525872 3.766355570657855 3.5635148735318722 3.7816829293604015; 4.184360673225802 2.999061735347273 3.7714074061222664 4.03957854108814 4.096553260767219 4.4041920574947735 4.063701078068846 5.238924978994242 3.78248503206378 3.5412097092125325 3.4339438694441946 3.6726680595762113 3.4320725568621504; 3.686506754981603 2.6338157258426955 3.1816399590200897 3.2689718094946736 3.1160453242472235 3.8202191319196657 3.4811602063535116 3.78248503206378 4.013111549639922 3.3862827494158796 3.3160315989579185 3.3632079863096678 2.924813966431777; 3.956425592736187 2.3170316055470366 2.579382316215362 3.0788109823745433 3.0433254088403214 3.1552546912847643 3.593823727525872 3.5412097092125325 3.3862827494158796 3.7568843665629057 3.2199809201688736 3.0413437786241726 3.1587621554909866; 3.8386930549642213 2.19639343438095 2.8456661210289584 2.7715184944657283 2.5230618484755913 3.278891977454557 3.766355570657855 3.4339438694441946 3.3160315989579185 3.2199809201688736 4.218011746285779 2.8040435981529614 3.0091957101807143; 3.487930041275693 2.4064248519728495 2.516956735298323 3.406436892560917 3.378845552461686 3.5342434612124354 3.5635148735318722 3.6726680595762113 3.3632079863096678 3.0413437786241726 2.8040435981529614 3.54740205752464 2.795007939324947; 3.215753736003255 2.5181103351141845 1.8823421427694251 3.573253183231616 3.209605597849173 3.2276762871187223 3.7816829293604015 3.4320725568621504 2.924813966431777 3.1587621554909866 3.0091957101807143 2.795007939324947 3.850499357181516]
    r5 = [0.7756347535701853, 0.8176676124497129, 0.8390823502619278, 0.20345569294312127, 0.5249185865556167, 0.9248127477536319, 0.9550833639891132, 0.684296128299557, 0.8188154337629974, 0.11472972558236294, 0.6035041250729105, 0.9399740399392191, 0.31271431225026247]
    s5 = [6.565683021540708, 7.055298067142543, 11.449335152716722, 15.04706173226238, 1.241492395356131, 6.347431609717376, 0.02361820928638847, -6.819027274652145, 15.777823629575733, -4.600117603347675, 4.0970794139612465, 18.119582523797202, 8.97563967655068]

    mv1, mv1_g, mv1_h = problem_from_multivariate_pair(A1, r1)
    mv2, mv2_g, mv2_h = problem_from_multivariate_pair(A2, r2)
    mv3, mv3_g, mv3_h = problem_from_multivariate_pair(A3, r3)
    mv4, mv4_g, mv4_h = problem_from_multivariate_pair(A4, r4)
    mv5, mv5_g, mv5_h = problem_from_multivariate_pair(A5, r5)

    const problems = [
        (f, f_g, f_h, f_s),
        (poly1, poly1_g, poly1_h, poly1_s),
        (poly2, poly2_g, poly2_h, poly2_s),
        (poly3, poly3_g, poly3_h, poly3_s),
        (poly4, poly4_g, poly4_h, poly4_s),
        (mv1, mv1_g, mv1_h, s1),
        (mv2, mv2_g, mv2_h, s2),
        (mv3, mv3_g, mv3_h, s3),
        (mv4, mv4_g, mv4_h, s4),
        (mv5, mv5_g, mv5_h, s5),
    ]
end
